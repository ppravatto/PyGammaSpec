<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pygammaspec.analysis module &mdash; PyGammaSpec User Guide</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
      <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script src="../_static/design-tabs.js"></script>
        <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
        <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pygammaspec.visualization module" href="visualization.html" />
    <link rel="prev" title="pygammaspec.spectrum module" href="spectrum.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../intro.html" class="icon icon-home">
            Python
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide.html">User guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="spectrum.html"><code class="docutils literal notranslate"><span class="pre">pygammaspec.spectrum</span></code> module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">pygammaspec.analysis</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html"><code class="docutils literal notranslate"><span class="pre">pygammaspec.visualization</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributor-guide.html">Contributor’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../intro.html">Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../intro.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API Documentation</a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">pygammaspec.analysis</span></code> module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/API/analysis.md" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="module-pygammaspec.analysis">
<span id="pygammaspec-analysis-module"></span><span id="api-analysis"></span><h1><code class="docutils literal notranslate"><span class="pre">pygammaspec.analysis</span></code> module<a class="headerlink" href="#module-pygammaspec.analysis" title="Permalink to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="pygammaspec.analysis.fit_peak">
<span class="sig-prename descclassname"><span class="pre">pygammaspec.analysis.</span></span><span class="sig-name descname"><span class="pre">fit_peak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygammaspec.analysis.fit_peak" title="Permalink to this definition"></a></dt>
<dd><p>The function perform a Gaussian fit of a single photopeak using a polynomial baseline of variable order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectrum</strong> (<a class="reference internal" href="spectrum.html#pygammaspec.spectrum.GammaSpectrum" title="pygammaspec.spectrum.GammaSpectrum"><em>GammaSpectrum</em></a>) – The spectrum object containing the data to be fitted. The spectrum must contain an energy calibration.</p></li>
<li><p><strong>emin</strong> (<em>float</em>) – The minimum energy defining the region to fit.</p></li>
<li><p><strong>emax</strong> (<em>float</em>) – The maximum energy defining the region to fit.</p></li>
<li><p><strong>baseline_order</strong> (<em>int</em>) – The order of the baseline function to be used.</p></li>
<li><p><strong>maxfev</strong> (<em>int</em>) – The maximum number of functon evaluation during optimization.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – Exception raised if the given spectrum has no energy calibration.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>List[float]</em> – The optimized fitting parameters. The array lists in order the height of the gaussian, its center and its standard
deviation and it ends with the coefficients of the baseline polynomial listed in ascending order. The lenght of the
list is <cite>3 + b + 1</cite> where <cite>b</cite> is the <cite>basline_order</cite>.</p></li>
<li><p><em>List[float]</em> – The list of energy datapoints used in the fitting.</p></li>
<li><p><em>List[float]</em> – The list of counts associated with the fitted function.</p></li>
<li><p><em>List[float]</em> – The list of counts associated with the baseline function.</p></li>
<li><p><em>float</em> – The estimated efficiency for the peak as 100*FWHM(E)/E.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[<em>List</em>[float], <em>List</em>[float], <em>List</em>[float], <em>List</em>[float], float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygammaspec.analysis.peak_search">
<span class="sig-prename descclassname"><span class="pre">pygammaspec.analysis.</span></span><span class="sig-name descname"><span class="pre">peak_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygammaspec.analysis.peak_search" title="Permalink to this definition"></a></dt>
<dd><p>Function running the <cite>scipy.signal.find_peaks</cite> funciton to detect peaks in the gamma spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prominence</strong> (<em>float</em>) – The prominence threshold to be used in the peak search (default: 0.01). The prominence of a peak measures
how much a peak stands out from the surrounding baseline of the signal and is defined as the vertical
distance between the peak and its lowest contour line.</p></li>
<li><p><strong>spectrum</strong> (<a class="reference internal" href="spectrum.html#pygammaspec.spectrum.GammaSpectrum" title="pygammaspec.spectrum.GammaSpectrum"><em>GammaSpectrum</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dictionary containing the index of the peak as the key and the tuple containing the channel, intensity
energy (in keV) as the value. If the spectrum is not calibrated the energy field will be filled with <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[int, Tuple[float, float, Optional[float]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygammaspec.analysis.unitary_height_gaussian">
<span class="sig-prename descclassname"><span class="pre">pygammaspec.analysis.</span></span><span class="sig-name descname"><span class="pre">unitary_height_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygammaspec.analysis.unitary_height_gaussian" title="Permalink to this definition"></a></dt>
<dd><p>Unitary height Gaussian function centered in <cite>x0</cite> and having a standar deviation of <cite>sigma</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – The point in which the function must be evaluated.</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – The center of the Gaussian function.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – The standard deviation of the Gaussian.</p></li>
<li><p><strong>Retruns</strong> – </p></li>
<li><p><strong>-------</strong> – </p></li>
<li><p><strong>float</strong> – The value of the funciont in <cite>x</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./API"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="spectrum.html" class="btn btn-neutral float-left" title="pygammaspec.spectrum module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="visualization.html" class="btn btn-neutral float-right" title="pygammaspec.visualization module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>